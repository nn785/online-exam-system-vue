(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41c111c2"],{"0878":function(e,t,a){"use strict";a("a7dd")},"2ac8":function(e,t,a){"use strict";var n=a("b775");t["a"]={getQuestionById(e){return Object(n["a"])({url:"/student/getQuestionById/"+e,method:"get"})},getQuestionByIds(e){return Object(n["a"])({url:"/student/getQuestionByIds",params:e,method:"get"})},getQuestion(e){return Object(n["a"])({url:"/teacher/getQuestion",method:"get",params:e})},deleteQuestion(e){return Object(n["a"])({url:"/teacher/deleteQuestion",method:"get",params:e})},addQuestion(e){return Object(n["a"])({url:"/teacher/addQuestion",method:"post",data:e})},importQuestion(e){return Object(n["a"])({url:"/teacher/importQuestion",method:"post",data:e})},updateQuestion(e){return Object(n["a"])({url:"/teacher/updateQuestion",method:"post",data:e})},getQuestionByBankIdAndType(e){return Object(n["a"])({url:"/public/getQuestionByBankIdAndType",method:"get",params:e})}}},"31c1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("el-container",[t("el-header",{attrs:{height:"220"}},[t("el-steps",{attrs:{active:e.curStep,simple:""}},[t("el-step",{attrs:{title:"组卷配置",icon:"el-icon-edit"}}),t("el-step",{attrs:{title:"考试权限",icon:"el-icon-lock"}}),t("el-step",{attrs:{title:"补充配置",icon:"el-icon-setting"}})],1),t("el-button",{directives:[{name:"show",rawName:"v-show",value:1!==e.curStep,expression:"curStep !== 1"}],staticStyle:{"margin-top":"10px"},on:{click:function(t){e.curStep--}}},[e._v("上一步")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:3!==e.curStep,expression:"curStep !== 3"}],staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"primary"},on:{click:function(t){e.curStep++}}},[e._v("下一步 ")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:3===e.curStep,expression:"curStep === 3"}],staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"primary"},on:{click:e.updateExam}},[e._v("提交 ")])],1),t("el-main",[t("el-card",{directives:[{name:"show",rawName:"v-show",value:1===e.curStep,expression:"curStep === 1"}]},[t("span",{staticStyle:{float:"right",color:"red","font-weight":"bold"}},[e._v(" "+e._s("试卷总分："+e.sumTotalScore))]),t("div",[t("el-card",[t("h1",[e._v("题目列表")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:e.showAddDialog}},[e._v("添加试题")]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}],staticStyle:{"margin-top":"10px"},attrs:{data:e.updateExamQuestion,border:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"50"}}),t("el-table-column",{attrs:{label:"题目内容",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.questionContent)+" ")]}}])}),t("el-table-column",{attrs:{align:"center",label:"题目类型"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.questionType?t("span",[e._v("单选题")]):2===a.row.questionType?t("span",[e._v("多选题")]):3===a.row.questionType?t("span",[e._v("判断题")]):4===a.row.questionType?t("span",[e._v("填空题")]):5===a.row.questionType?t("span",[e._v("简答题")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"单题分数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{staticStyle:{"margin-left":"5px"},model:{value:a.row.score,callback:function(t){e.$set(a.row,"score",t)},expression:"scope.row.score"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.delQuestion(a.row.questionId)}}})]}}])})],1)],1)],1)]),t("el-card",{directives:[{name:"show",rawName:"v-show",value:2===e.curStep,expression:"curStep === 2"}]},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.examInfo.type,callback:function(t){e.$set(e.examInfo,"type",t)},expression:"examInfo.type"}},[t("el-radio",{attrs:{label:1,border:""}},[e._v("完全公开")]),t("el-radio",{attrs:{label:2,border:""}},[e._v("需要密码")])],1),t("el-alert",{staticStyle:{"margin-top":"15px"},attrs:{title:1===e.examInfo.type?"开放的，任何人都可以进行考试！":"半开放的，知道密码的人员才可以考试！",type:"warning"}}),t("el-input",{directives:[{name:"show",rawName:"v-show",value:2===e.examInfo.type,expression:"examInfo.type === 2"}],staticStyle:{"margin-top":"15px",width:"20%"},attrs:{type:"password","show-password":"",placeholder:"输入考试密码"},model:{value:e.examInfo.password,callback:function(t){e.$set(e.examInfo,"password",t)},expression:"examInfo.password"}})],1),t("el-card",{directives:[{name:"show",rawName:"v-show",value:3===e.curStep,expression:"curStep === 3"}]},[t("el-form",{ref:"examInfoForm",attrs:{model:e.examInfo,rules:e.examInfoRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"考试名称",prop:"examName"}},[t("el-input",{model:{value:e.examInfo.examName,callback:function(t){e.$set(e.examInfo,"examName",t)},expression:"examInfo.examName"}})],1),t("el-form-item",{attrs:{label:"考试描述",prop:"examDesc"}},[t("el-input",{model:{value:e.examInfo.examDesc,callback:function(t){e.$set(e.examInfo,"examDesc",t)},expression:"examInfo.examDesc"}})],1),t("el-form-item",{attrs:{label:"总分数",prop:"totalScore"}},[t("el-input-number",{attrs:{value:e.sumTotalScore,disabled:!0}})],1),t("el-form-item",{attrs:{label:"及格分数",prop:"passScore"}},[t("el-input-number",{attrs:{min:1,max:e.sumTotalScore},model:{value:e.examInfo.passScore,callback:function(t){e.$set(e.examInfo,"passScore",t)},expression:"examInfo.passScore"}})],1),t("el-form-item",{attrs:{label:"考试时长(分钟)",prop:"examDuration"}},[t("el-input-number",{attrs:{min:1,max:120},model:{value:e.examInfo.examDuration,callback:function(t){e.$set(e.examInfo,"examDuration",t)},expression:"examInfo.examDuration"}})],1),t("el-form-item",{attrs:{label:"考试开始时间",prop:"startTime"}},[t("el-date-picker",{staticStyle:{"margin-left":"5px"},attrs:{placeholder:"考试开始时间",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"9:00:00"},model:{value:e.examInfo.startTime,callback:function(t){e.$set(e.examInfo,"startTime",t)},expression:"examInfo.startTime"}})],1),t("el-form-item",{attrs:{label:"考试结束时间",prop:"endTime"}},[t("el-date-picker",{staticStyle:{"margin-left":"5px"},attrs:{placeholder:"考试开始时间",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"18:00:00"},model:{value:e.examInfo.endTime,callback:function(t){e.$set(e.examInfo,"endTime",t)},expression:"examInfo.endTime"}})],1)],1)],1)],1),t("el-dialog",{attrs:{title:"添加题目",visible:e.showQuestionDialog,width:"80%",center:""},on:{"update:visible":function(t){e.showQuestionDialog=t}}},[t("el-row",[t("el-select",{attrs:{clearable:"",placeholder:"请选择题目类型"},on:{change:e.typeChange},model:{value:e.queryInfo.questionType,callback:function(t){e.$set(e.queryInfo,"questionType",t)},expression:"queryInfo.questionType"}},e._l(e.questionType,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),t("el-select",{staticStyle:{"margin-left":"5px"},attrs:{clearable:"",placeholder:"请选择题库"},on:{change:e.bankChange},model:{value:e.queryInfo.questionBank,callback:function(t){e.$set(e.queryInfo,"questionBank",t)},expression:"queryInfo.questionBank"}},e._l(e.allBank,(function(e){return t("el-option",{key:e.questionBank.bankId,attrs:{label:e.questionBank.bankName,value:e.questionBank.bankName}})})),1),t("el-input",{staticStyle:{"margin-left":"5px",width:"220px"},attrs:{placeholder:"题目内容","prefix-icon":"el-icon-search"},on:{blur:e.getQuestionInfo},model:{value:e.queryInfo.questionContent,callback:function(t){e.$set(e.queryInfo,"questionContent",t)},expression:"queryInfo.questionContent"}}),t("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.addQuToFree}},[e._v("确认"+e._s(e.selectedTable.length)+"项")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"questionTable",staticStyle:{width:"100%","margin-top":"25px"},attrs:{"highlight-current-row":"",border:!0,data:e.questionInfo,"tooltip-effect":"dark"},on:{"selection-change":e.handleTableSectionChange}},[t("el-table-column",{attrs:{align:"center",type:"selection",width:"55"}}),t("el-table-column",{attrs:{align:"center",label:"题目类型"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.quType?t("span",[e._v("单选题")]):2===a.row.quType?t("span",[e._v("多选题")]):3===a.row.quType?t("span",[e._v("判断题")]):4===a.row.quType?t("span",[e._v("填空题")]):5===a.row.quType?t("span",[e._v("简答题")]):e._e()]}}])}),t("el-table-column",{attrs:{align:"center",label:"题目内容"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"quContent"},[e._v(e._s(a.row.quContent))])]}}])}),t("el-table-column",{attrs:{align:"center",label:"难度"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.level?t("span",[e._v("简单")]):e._e(),2===a.row.level?t("span",[e._v("中等")]):e._e(),3===a.row.level?t("span",[e._v("困难")]):e._e()]}}])}),t("el-table-column",{attrs:{align:"center",prop:"quBankName",label:"所属题库"}}),t("el-table-column",{attrs:{align:"center",prop:"createPerson",label:"创建人"}}),t("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(new Date(t.row.createTime).toLocaleDateString())+" ")]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"25px"},attrs:{"current-page":e.queryInfo.pageNo,"page-sizes":[10,20,30,50],"page-size":e.queryInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},o=[],s=(a("14d9"),a("39f0")),r=a("2ac8"),i=a("8b81"),l=a("fa7d"),u={name:"UpdateExam",data(){return{queryInfo:{questionType:"",questionBank:"",questionContent:"",pageNo:1,pageSize:10},questionType:[{id:1,name:"单选题"},{id:2,name:"多选题"},{id:3,name:"判断题"},{id:4,name:"填空题"},{id:5,name:"简答题"}],allBank:[],curStep:1,updateExamQuestion:[],showQuestionDialog:!1,loading:!0,pageLoading:!0,questionInfo:[],selectedTable:[],total:0,examInfo:{},examInfoRules:{examName:[{required:!0,message:"请输入考试名称",trigger:"blur"}],passScore:[{required:!0,message:"请输入通过分数",trigger:"blur"}],examDuration:[{required:!0,message:"请输入考试时长",trigger:"blur"}]}}},props:["tagInfo"],created(){this.$emit("giveChildChangeBreakInfo","更新考试","更新考试"),this.createTagsInParent(),this.getExamInfo(),this.getBankInfo()},methods:{createTagsInParent(){let e=!1;this.tagInfo.map(t=>{"更新考试"===t.name&&t.url===this.$route.path?e=!0:"更新考试"===t.name&&t.url!==this.$route.path&&(this.$emit("updateTagInfo","更新考试",this.$route.path),e=!0)}),e||this.$emit("giveChildAddTag","更新考试",this.$route.path)},async getExamInfo(){await s["a"].getExamInfoById(this.$route.params).then(e=>{if(200===e.code){this.examInfo=e.data;let t=e.data.scores.split(",");const a=e.data.questionIds.split(","),n=new Map;for(let e=0;e<a.length;e++)n.set(a[e],t[e]);r["a"].getQuestionByIds({ids:e.data.questionIds}).then(e=>{var t;200===e.code&&((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data)||[]).forEach(e=>{this.updateExamQuestion.push({questionId:parseInt(e.questionId),questionType:e.questionType,questionContent:e.questionContent,score:n.get(""+e.questionId)})})}),this.pageLoading=!1}})},showAddDialog(){this.showQuestionDialog=!0,this.getQuestionInfo()},getBankInfo(){i["a"].getBankHaveQuestionSumByType({pageNo:1,pageSize:9999}).then(e=>{200===e.code?this.allBank=e.data.data:this.$notify({title:"Tips",message:e.message,type:"error",duration:2e3})})},getQuestionInfo(){r["a"].getQuestion(this.queryInfo).then(e=>{200===e.code?(this.questionInfo=e.data.data,this.total=e.data.total,this.loading=!1):this.$notify({title:"Tips",message:"获取题库信息失败",type:"error",duration:2e3})})},delQuestion(e){this.updateExamQuestion.forEach((t,a)=>{t.questionId===e&&this.updateExamQuestion.splice(a,1)})},typeChange(e){this.queryInfo.questionType=e,this.getQuestionInfo()},bankChange(e){this.queryInfo.questionBank=e,this.getQuestionInfo()},addQuToFree(){this.selectedTable.forEach(e=>{this.updateExamQuestion.some(t=>t.questionId===e.id)||this.updateExamQuestion.push({questionId:e.id,questionContent:e.quContent,questionType:e.quType,score:1})}),this.showQuestionDialog=!1},handleTableSectionChange(e){this.selectedTable=e},handleSizeChange(e){this.queryInfo.pageSize=e,this.getQuestionInfo()},handleCurrentChange(e){this.queryInfo.pageNo=e,this.getQuestionInfo()},updateExam(){l["a"].validFormAndInvoke(this.$refs["examInfoForm"],()=>{let e=this.examInfo;if(0!==this.updateExamQuestion.length){if(1===e.type&&(e.password=null),console.log(e),2===e.type&&(null===e.password||""===e.password))return this.$message.error("当前权限为需要密码,但是密码为空"),!1;let t=[],a=[];this.updateExamQuestion.forEach(e=>{t.push(e.questionId),a.push(e.score)}),e.questionIds=t.join(","),e.scores=a.join(","),s["a"].updateExamInfo(e).then(e=>{200===e.code&&(this.$notify({type:"success",title:"Tips",message:e.message,duration:2e3}),this.$router.push("/examManage"))})}else this.$message.error("请检查考试规则设置是否完整")},"请检查考试规则设置是否完整")}},computed:{sumTotalScore(){let e=0;return this.updateExamQuestion.forEach(t=>{e+=parseInt(t.score)}),this.examInfo.totalScore=e,e}}},d=u,c=(a("0878"),a("2877")),p=Object(c["a"])(d,n,o,!1,null,"375d51a2",null);t["default"]=p.exports},"39f0":function(e,t,a){"use strict";var n=a("b775");t["a"]={getExamInfo(e){return Object(n["a"])({url:"/public/getExamInfo",method:"post",data:e})},allExamInfo(){return Object(n["a"])({url:"/public/allExamInfo",method:"get"})},operationExam(e,t){return Object(n["a"])({url:"/teacher/operationExam/"+e,method:"get",params:t})},getExamRecord(e){return Object(n["a"])({url:"/teacher/getExamRecord",method:"get",params:e})},getExamInfoById(e){return Object(n["a"])({url:"/public/getExamInfoById",method:"get",params:e})},addExamRecord(e){return Object(n["a"])({url:"/student/addExamRecord",method:"post",data:e})},getExamRecordById(e){return Object(n["a"])({url:"/student/getExamRecordById/"+e,method:"get"})},getExamQuestionByExamId(e){return Object(n["a"])({url:"/student/getExamQuestionByExamId/"+e,method:"get"})},addExamByBank(e){return Object(n["a"])({url:"/teacher/addExamByBank",method:"post",data:e})},addExamByQuestionList(e){return Object(n["a"])({url:"/teacher/addExamByQuestionList",method:"post",data:e})},updateExamInfo(e){return Object(n["a"])({url:"/teacher/updateExamInfo",method:"post",data:e})},getQuestionIdsByExamId(e){return Object(n["a"])({url:"/teacher/getQuestionIdsByExamId",method:"get",params:e})}}},"8b81":function(e,t,a){"use strict";var n=a("b775");t["a"]={getBankHaveQuestionSumByType(e){return Object(n["a"])({url:"/public/getBankHaveQuestionSumByType",method:"get",params:e})},deleteQuestionBank(e){return Object(n["a"])({url:"/teacher/deleteQuestionBank",method:"get",params:e})},addQuestionBank(e){return Object(n["a"])({url:"/teacher/addQuestionBank",method:"post",data:e})},getQuestionBank(){return Object(n["a"])({url:"/teacher/getQuestionBank",method:"get"})},addBankQuestion(e){return Object(n["a"])({url:"/teacher/addBankQuestion",method:"get",params:e})},removeBankQuestion(e){return Object(n["a"])({url:"/teacher/removeBankQuestion",method:"get",params:e})},getQuestionByBank(e){return Object(n["a"])({url:"/public/getQuestionByBank",method:"get",params:e})}}},a7dd:function(e,t,a){},fa7d:function(e,t,a){"use strict";var n=a("2b0e");const o=()=>Math.floor(1e7*Math.random()),s=(e,t,a="信息有误",o=function(){})=>{e&&e.validate(s=>{if(!s)return n["default"].prototype.$notify({title:"Tips",message:a,type:"error",duration:2e3}),o(),!1;t(),e.resetFields()})},r=(e,t,a,o=function(){})=>{e&&e.validate(e=>{if(!e)return n["default"].prototype.$notify({title:"Tips",message:a,type:"error",duration:2e3}),o(),!1;t()})};t["a"]={validFormAndInvoke:s,validFormNotEmpty:r,getRandomId:o}}}]);
//# sourceMappingURL=chunk-41c111c2.ef2c8fcd.js.map