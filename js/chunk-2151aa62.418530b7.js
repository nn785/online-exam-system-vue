(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2151aa62"],{"0b74":function(e,t,n){},"2ac8":function(e,t,n){"use strict";var s=n("b775");t["a"]={getQuestionById(e){return Object(s["a"])({url:"/student/getQuestionById/"+e,method:"get"})},getQuestionByIds(e){return Object(s["a"])({url:"/student/getQuestionByIds",params:e,method:"get"})},getQuestion(e){return Object(s["a"])({url:"/teacher/getQuestion",method:"get",params:e})},deleteQuestion(e){return Object(s["a"])({url:"/teacher/deleteQuestion",method:"get",params:e})},addQuestion(e){return Object(s["a"])({url:"/teacher/addQuestion",method:"post",data:e})},importQuestion(e){return Object(s["a"])({url:"/teacher/importQuestion",method:"post",data:e})},updateQuestion(e){return Object(s["a"])({url:"/teacher/updateQuestion",method:"post",data:e})},getQuestionByBankIdAndType(e){return Object(s["a"])({url:"/public/getQuestionByBankIdAndType",method:"get",params:e})}}},3522:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e._self._c;return e.show?t("el-container",[t("el-header",{staticStyle:{"margin-top":"60px"}},[t("el-row",[t("el-col",{staticStyle:{"border-bottom":"1px solid #f5f5f5"},attrs:{span:18,offset:3}},[t("span",{staticClass:"startExam"},[e._v("开始考试")]),t("span",{staticClass:"examTitle"},[e._v("距离考试结束还有：")]),t("span",{staticStyle:{color:"red","font-size":"18px"}},[e._v(e._s(e._f("timeFormat")(e.duration)))]),t("el-button",{staticStyle:{"background-color":"#ffd550",float:"right",color:"black","font-weight":"800"},attrs:{type:"warning",round:""},on:{click:e.uploadExamToAdmin}},[e._v("提交试卷 ")])],1)],1)],1),t("el-main",[t("el-row",[t("el-col",{attrs:{span:18,offset:3}},[t("el-col",{attrs:{span:16}},[t("el-card",{staticStyle:{"min-height":"500px"}},[t("div",[t("i",{staticClass:"num"},[e._v(e._s(e.curIndex+1))]),1===e.questionInfo[e.curIndex].questionType?t("span",[e._v("【单选题】")]):2===e.questionInfo[e.curIndex].questionType?t("span",[e._v("【多选题】")]):3===e.questionInfo[e.curIndex].questionType?t("span",[e._v("【判断题】")]):4===e.questionInfo[e.curIndex].questionType?t("span",[e._v("【填空题】")]):t("span",[e._v("【简答题】")]),t("span",[e._v(e._s(e.questionInfo[e.curIndex].questionContent))])]),e._l(e.questionInfo[e.curIndex].images,(function(n){return t("img",{staticStyle:{width:"100px",height:"100px",cursor:"pointer"},attrs:{src:e.imgUrl+n,title:"点击查看大图",alt:"题目图片"},on:{click:function(t){return e.showBigImg(n)}}})})),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.questionInfo[e.curIndex].questionType||3===e.questionInfo[e.curIndex].questionType,expression:"questionInfo[curIndex].questionType === 1 || questionInfo[curIndex].questionType === 3"}],staticStyle:{"margin-top":"25px"}},[t("div",{staticClass:"el-radio-group"},e._l(e.questionInfo[e.curIndex].answer,(function(n,s){return t("label",{class:s===e.userAnswer[e.curIndex]?"active":"",on:{click:function(t){return e.checkSingleAnswer(s)}}},[t("span",[e._v(e._s(e.optionName[s]+"、"+n.answer))])])})),0)]),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.questionInfo[e.curIndex].questionType,expression:"questionInfo[curIndex].questionType === 2"}],staticStyle:{"margin-top":"25px"}},[t("div",{staticClass:"el-radio-group"},e._l(e.questionInfo[e.curIndex].answer,(function(n,s){return t("label",{class:-1!==(e.userAnswer[e.curIndex]+"").indexOf(s+"")?"active":"",on:{click:function(t){return e.selectedMultipleAnswer(s)}}},[t("span",[e._v(e._s(e.optionName[s]+"、"+n.answer))])])})),0)]),t("div",{directives:[{name:"show",rawName:"v-show",value:4===e.questionInfo[e.curIndex].questionType,expression:"questionInfo[curIndex].questionType === 4"}],staticStyle:{"margin-top":"25px"}},[t("div",{staticStyle:{color:"red"}},[e._v("* 多个空请用“ ; ”隔开")]),t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入答案"},model:{value:e.userAnswer[e.curIndex],callback:function(t){e.$set(e.userAnswer,e.curIndex,t)},expression:"userAnswer[curIndex]"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:5===e.questionInfo[e.curIndex].questionType,expression:"questionInfo[curIndex].questionType === 5"}],staticStyle:{"margin-top":"25px"}},[t("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入答案"},model:{value:e.userAnswer[e.curIndex],callback:function(t){e.$set(e.userAnswer,e.curIndex,t)},expression:"userAnswer[curIndex]"}})],1),t("div",{staticStyle:{"margin-top":"25px"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-back",disabled:e.curIndex<1},on:{click:function(t){e.curIndex--}}},[e._v("上一题")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-right",disabled:e.curIndex>=e.questionInfo.length-1},on:{click:function(t){e.curIndex++}}},[e._v("下一题 ")])],1)],2)],1),t("el-col",{attrs:{span:7,offset:1}},[t("el-card",[t("div",[t("p",{staticStyle:{"font-size":"18px"}},[e._v("答题卡")]),t("div",{staticStyle:{"margin-top":"25px"}},[t("span",{staticStyle:{"background-color":"rgb(238,238,238)",padding:"5px 10px 5px 10px","margin-left":"15px"}},[e._v("未作答")]),t("span",{staticStyle:{"background-color":"rgb(87,148,247)",color:"white",padding:"5px 10px 5px 10px","margin-left":"15px"}},[e._v("已作答")])])]),t("div",{staticStyle:{"margin-top":"25px"}},[t("p",{staticStyle:{"font-size":"18px"}},[e._v("单选题")]),e._l(e.questionInfo.length,(function(n){return t("el-button",{directives:[{name:"show",rawName:"v-show",value:1===e.questionInfo[n-1].questionType,expression:"questionInfo[item-1].questionType === 1"}],key:n,class:1===e.questionInfo[n-1].questionType&&void 0!==e.userAnswer[n-1]?"done":void 0===e.userAnswer[n-1]&&e.curIndex===n-1?"orange":"noAnswer",staticStyle:{"margin-top":"10px","margin-left":"15px"},attrs:{size:"mini"},on:{click:function(t){e.curIndex=n-1}}},[e._v(e._s(n)+" ")])}))],2),t("div",{staticStyle:{"margin-top":"25px"}},[t("p",{staticStyle:{"font-size":"18px"}},[e._v("多选题")]),e._l(e.questionInfo.length,(function(n){return t("el-button",{directives:[{name:"show",rawName:"v-show",value:2===e.questionInfo[n-1].questionType,expression:"questionInfo[item-1].questionType === 2"}],key:n,class:2===e.questionInfo[n-1].questionType&&void 0!==e.userAnswer[n-1]?"done":void 0===e.userAnswer[n-1]&&e.curIndex===n-1?"orange":"noAnswer",staticStyle:{"margin-top":"10px","margin-left":"15px"},attrs:{size:"mini"},on:{click:function(t){e.curIndex=n-1}}},[e._v(e._s(n)+" ")])}))],2),t("div",{staticStyle:{"margin-top":"25px"}},[t("p",{staticStyle:{"font-size":"18px"}},[e._v("判断题")]),e._l(e.questionInfo.length,(function(n){return t("el-button",{directives:[{name:"show",rawName:"v-show",value:3===e.questionInfo[n-1].questionType,expression:"questionInfo[item-1].questionType === 3"}],key:n,class:3===e.questionInfo[n-1].questionType&&void 0!==e.userAnswer[n-1]?"done":void 0===e.userAnswer[n-1]&&e.curIndex===n-1?"orange":"noAnswer",staticStyle:{"margin-top":"10px","margin-left":"15px"},attrs:{size:"mini"},on:{click:function(t){e.curIndex=n-1}}},[e._v(e._s(n)+" ")])}))],2),t("div",{staticStyle:{"margin-top":"25px"}},[t("p",{staticStyle:{"font-size":"18px"}},[e._v("填空题")]),e._l(e.questionInfo.length,(function(n){return t("el-button",{directives:[{name:"show",rawName:"v-show",value:4===e.questionInfo[n-1].questionType,expression:"questionInfo[item-1].questionType === 4"}],key:n,class:4===e.questionInfo[n-1].questionType&&void 0!==e.userAnswer[n-1]?"done":void 0===e.userAnswer[n-1]&&e.curIndex===n-1?"orange":"noAnswer",staticStyle:{"margin-top":"10px","margin-left":"15px"},attrs:{size:"mini"},on:{click:function(t){e.curIndex=n-1}}},[e._v(e._s(n)+" ")])}))],2),t("div",{staticStyle:{"margin-top":"25px"}},[t("p",{staticStyle:{"font-size":"18px"}},[e._v("简答题")]),e._l(e.questionInfo.length,(function(n){return t("el-button",{directives:[{name:"show",rawName:"v-show",value:5===e.questionInfo[n-1].questionType,expression:"questionInfo[item-1].questionType === 5"}],key:n,class:5===e.questionInfo[n-1].questionType&&void 0!==e.userAnswer[n-1]?"done":void 0===e.userAnswer[n-1]&&e.curIndex===n-1?"orange":"noAnswer",staticStyle:{"margin-top":"10px","margin-left":"15px"},attrs:{size:"mini"},on:{click:function(t){e.curIndex=n-1}}},[e._v(e._s(n)+" ")])}))],2)])],1)],1)],1),t("video",{staticStyle:{float:"right",position:"fixed",top:"80%",left:"85%"},attrs:{id:"video",muted:"muted",width:"200px",height:"200px",autoplay:"autoplay"},domProps:{muted:!0}}),t("canvas",{attrs:{id:"canvas",hidden:"",width:"200px",height:"200px"}})],1),t("el-dialog",{attrs:{visible:e.bigImgDialog},on:{"update:visible":function(t){e.bigImgDialog=t},close:function(t){e.bigImgDialog=!1}}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.imgUrl+e.bigImgUrl}})])],1):e._e()},i=[],o=(n("14d9"),n("39f0")),r=n("2ac8"),a=(n("b775"),{name:"ExamPage",data(){return{imgUrl:Object({NODE_ENV:"production",BASE_URL:""}).VUE_APP_IMAGE_URL,examInfo:{},questionInfo:[{questionType:""}],curIndex:0,bigImgDialog:!1,bigImgUrl:"",userAnswer:[],loading:{},show:!1,optionName:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],duration:0}},created(){this.getExamInfo(),this.loading=this.$Loading.service({body:!0,lock:!0,text:"数据拼命加载中,(*╹▽╹*)",spinner:"el-icon-loading"})},mounted(){let e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,s=e.indexOf("rv:11.0")>-1,i=e.indexOf("Edge")>-1&&!n;if(!n&&!i&&!s){let e=0,t=0;navigator.userAgent.indexOf("Firefox");window.onunload=function(){t=(new Date).getTime()-e,t<=5&&localStorage.removeItem("examDuration"+this.examInfo.examId)},window.onbeforeunload=function(){e=(new Date).getTime()}}},methods:{getExamInfo(){o["a"].getExamInfoById(this.$route.params).then(e=>{if(200===e.code){this.examInfo=e.data;try{const t=JSON.parse(localStorage.getItem("examDuration"+this.examInfo.examId)||"{}");(0===t.duration||Date.now()>=(t.timestamp||Date.now())+(1e3*t.duration||Date.now()))&&localStorage.removeItem("examDuration"+this.examInfo.examId),this.duration=Math.min(JSON.parse(localStorage.getItem("examDuration"+this.examInfo.examId)||"{}").duration||60*e.data.examDuration,60*e.data.examDuration)}catch(t){localStorage.removeItem("examDuration"+this.examInfo.examId)}this.timer=window.setInterval(()=>{this.duration>0&&this.duration--},1e3),this.getQuestionInfo(e.data.questionIds.split(","))}})},async getQuestionInfo(e){await r["a"].getQuestionByIds({ids:e.join(",")}).then(e=>{var t;200===e.code&&(this.questionInfo=(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data)||[],this.questionInfo=this.questionInfo.sort((function(e,t){return e.questionType-t.questionType})))}),this.loading.close(),this.show=!0},showBigImg(e){this.bigImgUrl=e,this.bigImgDialog=!0},checkSingleAnswer(e){this.$set(this.userAnswer,this.curIndex,e)},selectedMultipleAnswer(e){if(void 0===this.userAnswer[this.curIndex])this.$set(this.userAnswer,this.curIndex,e);else if(String(this.userAnswer[this.curIndex]).split(",").includes(e+"")){let t=[];String(this.userAnswer[this.curIndex]).split(",").forEach(n=>{n!==""+e&&t.push(n)}),0===t.length?this.$set(this.userAnswer,this.curIndex,void 0):(this.$set(this.userAnswer,this.curIndex,t.join(",")),this.userAnswer[this.curIndex]=String(this.userAnswer[this.curIndex]).split(",").sort((function(e,t){return e-t})).join(","))}else(this.userAnswer[this.curIndex]+"").split(",").includes(e+"")||(this.$set(this.userAnswer,this.curIndex,this.userAnswer[this.curIndex]+=","+e),this.userAnswer[this.curIndex]=String(this.userAnswer[this.curIndex]).split(",").sort((function(e,t){return e-t})).join(","))},submitExam(e){o["a"].addExamRecord(e).then(e=>{200===e.code&&(this.$notify({title:"Tips",message:"考试结束 *^▽^*",type:"success",duration:2e3}),this.$router.push("/examResult/"+e.data))})},async uploadExamToAdmin(){let e=new RegExp("-","g"),t=new RegExp("；","g");this.userAnswer.forEach((n,s)=>{5===this.questionInfo[s].questionType?this.userAnswer[s]=n.replace(e," "):4===this.questionInfo[s].questionType&&(this.userAnswer[s]=n.replace(e," "),this.userAnswer[s]=n.replace(t,";"))});let n=!0;for(let s=0;s<this.userAnswer.length;s++)void 0===this.userAnswer[s]&&(n=!1);if(this.userAnswer.length<this.questionInfo.length&&(n=!1),n){let e={questionIds:[]};e.userAnswers=this.userAnswer.join("-"),e.examId=parseInt(this.$route.params.examId),this.questionInfo.forEach((t,n)=>{e.questionIds.push(t.questionId)}),e.questionIds=e.questionIds.join(","),this.submitExam(e)}else this.$confirm("当前试题暂未做完, 是否继续提交o(╥﹏╥)o ?","Tips",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let e={questionIds:[]};e.userAnswers=this.userAnswer.join("-"),this.questionInfo.forEach((t,n)=>{e.questionIds.push(t.questionId),n>this.userAnswer.length-1&&(e.userAnswers+="- ")}),0===this.userAnswer.length&&(this.questionInfo.forEach(t=>{e.userAnswers+=" -"}),e.userAnswers.split(0,e.userAnswers.length-1)),e.examId=parseInt(this.$route.params.examId),e.questionIds=e.questionIds.join(","),this.submitExam(e)}).catch(()=>{this.$notify({title:"Tips",message:"继续加油! *^▽^*",type:"success",duration:2e3})})}},watch:{async duration(e){const t={duration:e,timestamp:Date.now()};if(localStorage.setItem("examDuration"+this.examInfo.examId,JSON.stringify(t)),e<1){let e={questionIds:[]};e.userAnswers=this.userAnswer.join("-"),this.questionInfo.forEach((t,n)=>{e.questionIds.push(t.questionId),n>this.userAnswer.length&&(e.userAnswers+=" -")}),""===e.userAnswers&&(this.questionInfo.forEach(t=>{e.userAnswers+=" -"}),e.userAnswers.split(0,e.userAnswers.length-1)),e.examId=parseInt(this.$route.params.examId),e.questionIds=e.questionIds.join(","),o["a"].addExamRecord(e).then(e=>{200===e.code&&(this.$notify({title:"Tips",message:"考试时间结束,已为您自动提交 *^▽^*",type:"success",duration:2e3}),this.$router.push("/examResult/"+e.data))})}}}}),u=a,d=(n("474d"),n("2877")),c=Object(d["a"])(u,s,i,!1,null,"acee34d2",null);t["default"]=c.exports},"39f0":function(e,t,n){"use strict";var s=n("b775");t["a"]={getExamInfo(e){return Object(s["a"])({url:"/public/getExamInfo",method:"post",data:e})},allExamInfo(){return Object(s["a"])({url:"/public/allExamInfo",method:"get"})},operationExam(e,t){return Object(s["a"])({url:"/teacher/operationExam/"+e,method:"get",params:t})},getExamRecord(e){return Object(s["a"])({url:"/teacher/getExamRecord",method:"get",params:e})},getExamInfoById(e){return Object(s["a"])({url:"/public/getExamInfoById",method:"get",params:e})},addExamRecord(e){return Object(s["a"])({url:"/student/addExamRecord",method:"post",data:e})},getExamRecordById(e){return Object(s["a"])({url:"/student/getExamRecordById/"+e,method:"get"})},getExamQuestionByExamId(e){return Object(s["a"])({url:"/student/getExamQuestionByExamId/"+e,method:"get"})},addExamByBank(e){return Object(s["a"])({url:"/teacher/addExamByBank",method:"post",data:e})},addExamByQuestionList(e){return Object(s["a"])({url:"/teacher/addExamByQuestionList",method:"post",data:e})},updateExamInfo(e){return Object(s["a"])({url:"/teacher/updateExamInfo",method:"post",data:e})},getQuestionIdsByExamId(e){return Object(s["a"])({url:"/teacher/getQuestionIdsByExamId",method:"get",params:e})}}},"474d":function(e,t,n){"use strict";n("0b74")}}]);
//# sourceMappingURL=chunk-2151aa62.418530b7.js.map